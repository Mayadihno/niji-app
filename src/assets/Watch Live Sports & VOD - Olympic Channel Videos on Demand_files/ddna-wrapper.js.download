!function(){"use strict";function n(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e(n)}function t(n){var t=function(n,t){if("object"!==e(n)||null===n)return n;var r=n[Symbol.toPrimitive];if(void 0!==r){var o=r.call(n,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"===e(t)?t:String(t)}function r(n,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,t(o.key),o)}}function o(n,e,t){return e&&r(n.prototype,e),t&&r(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function i(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function a(n){return function(n){if(Array.isArray(n))return i(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(n){if("string"==typeof n)return i(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(n,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(n,e,r){return(e=t(e))in n?Object.defineProperty(n,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[e]=r,n}function s(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var c=function(){function e(){n(this,e),d(this,"enabled",!1)}return o(e,[{key:"getCookie",value:function(n){var e,t=n+"=",r=document.cookie.split(";").map((function(n){return n.includes("_gig_llu")?escape(n):n})).join(";"),o=function(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return s(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,d=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return a=n.done,n},e:function(n){d=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(d)throw i}}}}(decodeURIComponent(r).split(";"));try{for(o.s();!(e=o.n()).done;){var i=e.value;if(-1!==i.indexOf(t))return i.substring(i.indexOf(t)+t.length,i.length)}}catch(n){o.e(n)}finally{o.f()}return""}},{key:"log",value:function(n){if(this.enabled){for(var e,t=Date.now()-window.ddnawrapper.diagnostic.startTime,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var d=null!=o?o:[];d=d.length>0?d.flat():"",(e=console).debug.apply(e,[t+" ms. DDNA WRAPPER - "+n].concat(a(d)))}}},{key:"init",value:function(){window.ddnawrapper=window.ddnawrapper||{};var n=window.ddnawrapper.diagnostic||{initialized:!1};if(!n.initialized){var e=this.getCookie("d3Debug");this.enabled=e.length>0,n.enabled=this.enabled,n.initialized=!0,n.startTime=Date.now(),n.log=this.log,window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.diagnostic=window.ddnawrapper.diagnostic||{},window.ddnawrapper.diagnostic=n,n.log("Diagnostic enabled by cookie")}}}]),e}();function u(n){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},u(n)}function l(n,e){for(;!Object.prototype.hasOwnProperty.call(n,e)&&null!==(n=u(n)););return n}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(n,e,t){var r=l(n,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?n:t):o.value}},p.apply(this,arguments)}function w(n,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,e){return n.__proto__=e,n},w(n,e)}function f(n,t){if(t&&("object"===e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function g(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function v(n){var e=new URLSearchParams(window.location.search),t=Object.fromEntries(e.entries());return n&&t&&t.length>0?t[n]:t}function y(){return!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g)}function h(n){var e,t=n+"=",r=document.cookie.split(";").map((function(n){return n.includes("_gig_llu")?escape(n):n})).join(";"),o=function(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return g(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?g(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,d=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return a=n.done,n},e:function(n){d=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(d)throw i}}}}(decodeURIComponent(r).split(";"));try{for(o.s();!(e=o.n()).done;){var i=e.value;if(-1!==i.indexOf(t))return i.substring(i.indexOf(t)+t.length,i.length)}}catch(n){o.e(n)}finally{o.f()}return""}var m="/api/js/usernation",b="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js",C=function(){function e(){n(this,e),this.isLoaded=!1,this.hasOptanonBoxClosedCookie=!1,this.isOptOutMode=!1,window.ddnawrapper.consent=window.ddnawrapper.consent||{},window.ddnawrapper.consent.fillD3ConsentVariablesFromOneTrustCookie=this.fillD3ConsentVariablesFromOneTrustCookie,window.ddnawrapper.events=window.ddnawrapper.events||{}}return o(e,[{key:"triggerCookieLoadedEvent",value:function(){if(window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.events=window.ddnawrapper.events||{},!window.ddnawrapper.events.cookieLoadedTriggered){var n=new CustomEvent("cookies-loaded");window.dispatchEvent(n),window.ddnawrapper.events.cookieLoadedTriggered=!0}}},{key:"initFunctionsForThirdParties",value:function(){var n=window.ddnawrapper.diagnostic||{},e=window.GlobalConfiguration||{};n.log("Init consent object"),window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.consent=window.ddnawrapper.consent||{},window.ddnawrapper.consent.isSpecialTerritory=function(){var t=e.segmentSpecialMarkets||"",r=window.deltatre.userNation;if(void 0===r)return console.warn("User nation not yet ready"),null;var o=v("user_nation");return o&&(n.log("User nation overwritten by query string parameter. Was: ".concat(r," and has been set to ").concat(o)),("string"==typeof o||o instanceof String)&&(r=o.toUpperCase())),n.log("Current user nation is: ".concat(r,". Special territories is: ").concat(t)),-1!==t.indexOf(r)};var t=function(){var t,r,o;ddnawrapper.consent.fillD3ConsentVariablesFromOneTrustCookie(),n.log("Checking if marketing/tracking consent has been given");var i=e.segmentCookieCategory||"C0004";return void 0!==(null===(t=ddnawrapper.consent)||void 0===t?void 0:t.consentCategories)&&(null===(r=ddnawrapper.consent)||void 0===r?void 0:r.consentCategories[i])&&"1"===(null===(o=ddnawrapper.consent)||void 0===o?void 0:o.consentCategories[i])};window.ddnawrapper.consent.isTrackingConsentGiven=function(){return t()},window.ddnawrapper.consent.isMarketingConsentGiven=function(){return t()},window.ddnawrapper.consent.isSocialMediaConsentGiven=function(){var t,r,o;ddnawrapper.consent.fillD3ConsentVariablesFromOneTrustCookie(),n.log("Checking if social media consent has been given");var i=e.socialMediaCookieCategory||"C0005";return void 0!==(null===(t=ddnawrapper.consent)||void 0===t?void 0:t.consentCategories)&&(null===(r=ddnawrapper.consent)||void 0===r?void 0:r.consentCategories[i])&&"1"===(null===(o=ddnawrapper.consent)||void 0===o?void 0:o.consentCategories[i])},window.ddnawrapper.consent.isPerformanceConsentGiven=function(){var t,r,o;ddnawrapper.consent.fillD3ConsentVariablesFromOneTrustCookie(),n.log("Checking if performances consent has been given");var i=e.performancesCookieCategory||"C0002";return void 0!==(null===(t=ddnawrapper.consent)||void 0===t?void 0:t.consentCategories)&&(null===(r=ddnawrapper.consent)||void 0===r?void 0:r.consentCategories[i])&&"1"===(null===(o=ddnawrapper.consent)||void 0===o?void 0:o.consentCategories[i])},window.ddnawrapper.consent.getConsentFromCookie=function(){var n=h("OptanonConsent");if(n.length>0)return ddnawrapper.consent.decodeOptanonConsentCookie(n).groups},window.ddnawrapper.consent.isConsentGiven=function(){var n;return!(null===(n=window.ddnawrapper.events)||void 0===n||!n.cookieLoadedTriggered)&&window.ddnawrapper.events.cookieLoadedTriggered}}},{key:"init",value:function(n){var t;window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.consent=window.ddnawrapper.consent||{},n&&(e.externalConsent=n),window.ddnawrapper.consent.decodeOptanonConsentCookie=function(n){var e={};return n.split("&").forEach((function(n){var t=n.split("=");2===t.length&&(e[t[0]]=t[1])})),e},this.initFunctionsForThirdParties(),window.ddnawrapper.consent.fillD3ConsentVariablesFromOneTrustCookie(n)&&(this.hasOptanonBoxClosedCookie=h("OptanonAlertBoxClosed").length>0,this.isOptOutMode=(null===(t=ddnawrapper.consent)||void 0===t?void 0:t.consentCategories)&&ddnawrapper.consent.consentCategories.length>1,(this.hasOptanonBoxClosedCookie||this.isOptOutMode)&&this.triggerCookieLoadedEvent())}},{key:"fillD3ConsentVariablesFromOneTrustCookie",value:function(){var n=h("OptanonConsent");if(e.externalConsent)return ddnawrapper.consent.consentCategories=e.externalConsent,!0;if(n.length>0){var t,r=ddnawrapper.consent.decodeOptanonConsentCookie(n).groups;return r&&(ddnawrapper.consent.consentCategories=(null===(t=ddnawrapper.consent)||void 0===t?void 0:t.consentCategories)||{},r.split(",").forEach((function(n){var e=n.split(":");2===e.length&&(ddnawrapper.consent.consentCategories[e[0]]=e[1])}))),!0}return!1}}]),e}();d(C,"externalConsent",void 0);var k=function(e){!function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&w(n,e)}(a,e);var t,r,i=(t=a,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}(),function(){var n,e=u(t);if(r){var o=u(this).constructor;n=Reflect.construct(e,arguments,o)}else n=e.apply(this,arguments);return f(this,n)});function a(){return n(this,a),i.apply(this,arguments)}return o(a,[{key:"init",value:function(){try{window.ddnawrapper=window.ddnawrapper||{};var n,e=window.ddnawrapper.diagnostic||{initialized:!1};return p(u(a.prototype),"init",this).call(this),window.addEventListener("cookies-loaded",(function(){e.log("triggered cookies-loaded");var n=!!window.OptanonActiveGroups&&ddnawrapper.consent.isPerformanceConsentGiven();window["ga-disable-@googleAnalyticsId"]=!n})),"function"==typeof window.OptanonWrapper&&(n=window.OptanonWrapper),window.OptanonWrapper=function(){e.log("OptanonWrapper - Entered"),window.dataLayer.push({event:"OneTrustGroupsUpdated"});var t="opt-in";try{t=Optanon.GetDomainData().ConsentModel.Name}catch(n){}if(Optanon.IsAlertBoxClosedAndValid()||"opt-out"===t){var r,o;e.log("OptanonWrapper - IsAlertBoxClosedAndValid");var i=JSON.stringify(ddnawrapper.consent.consentCategories);null===(r=ddnawrapper)||void 0===r||null===(o=r.consent)||void 0===o||o.fillD3ConsentVariablesFromOneTrustCookie();var a=JSON.stringify(ddnawrapper.consent.consentCategories);if("opt-out"!==t||ddnawrapper.consent.consentCategories||(ddnawrapper.consent.consentCategories={C0001:"1",C0002:"1",C0003:"1",C0004:"1",C0005:"1"}),window.ddnawrapper.events.cookieLoadedTriggered)if(i===a)e.log("OptanonWrapper - cookie consent unchanged");else{e.log("OptanonWrapper - triggering cookie consent updated");var d=new CustomEvent("cookies-consent-updated");window.dispatchEvent(d)}else{e.log("OptanonWrapper - triggering cookie loaded");var s=new CustomEvent("cookies-loaded");window.dispatchEvent(s),window.ddnawrapper.events.cookieLoadedTriggered=!0}}else if(window.ddnawrapper.events.cookieBannerShownTriggered)window.ddnawrapper.diagnostic.log("Opt in mode, consent not yet ready and cookies banner shown event already triggered");else{window.ddnawrapper.diagnostic.log("Opt in mode, consent not yet ready -> triggering cookies banner shown event");var c=new CustomEvent("cookies-banner-shown");window.dispatchEvent(c),window.ddnawrapper.events.cookieBannerShownTriggered=!0}"function"==typeof n&&n()},t&&t.then||(t=Promise.resolve(t)),t}catch(n){return Promise.reject(n)}var t}},{key:"externalConsentGiven",value:function(n){var e,t,r=JSON.stringify(ddnawrapper.consent.consentCategories);p(u(a.prototype),"init",this).call(this,n),window.ddnawrapper.diagnostic.log("Consent - received external consent. Populating categories"),null===(e=window.ddnawrapper)||void 0===e||null===(t=e.consent)||void 0===t||t.fillD3ConsentVariablesFromOneTrustCookie();var o=JSON.stringify(ddnawrapper.consent.consentCategories);if(window.ddnawrapper.events.cookieLoadedTriggered)if(r===o)window.ddnawrapper.diagnostic.log("Consent - cookie consent unchanged");else{window.ddnawrapper.diagnostic.log("Consent - triggering cookie consent updated");var i=new CustomEvent("cookies-consent-updated");window.dispatchEvent(i)}else{window.ddnawrapper.diagnostic.log("Consent - triggering cookie loaded");var d=new CustomEvent("cookies-loaded");window.dispatchEvent(d),window.ddnawrapper.events.cookieLoadedTriggered=!0}}}]),a}(C);function O(n,e,t){new IntersectionObserver((function(n,e){n.forEach((function(n){t(n,e)}))}),e).observe(n)}function A(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function I(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function S(n){var e,t,r;return void 0!==(null===(e=ddnawrapper.consent)||void 0===e?void 0:e.consentCategories)&&(null===(t=ddnawrapper.consent)||void 0===t?void 0:t.consentCategories[n])&&"1"===(null===(r=ddnawrapper.consent)||void 0===r?void 0:r.consentCategories[n])}function j(n){var e,t,r,o,i,a,d=n?null===(e=window.GlobalConfiguration.segmentGranularConsentConfiguration.specialTerritories)||void 0===e?void 0:e.purposesCategories:null===(t=window.GlobalConfiguration.segmentGranularConsentConfiguration.nonSpecialTerritories)||void 0===t?void 0:t.purposesCategories;return S(null==d||null===(r=d.analytics)||void 0===r?void 0:r.category)||S(null==d||null===(o=d.marketing)||void 0===o?void 0:o.category)||S(null==d||null===(i=d.profiling)||void 0===i?void 0:i.category)||S(null==d||null===(a=d.retargeting)||void 0===a?void 0:a.category)}function P(n){window.ddnawrapper.diagnostic.log("check if user is in a special market");var e=window.deltatre.userNation,t=("user_nation",new URLSearchParams(window.location.search).get("user_nation"));return t&&(window.ddnawrapper.diagnostic.log("User nation overwritten by query string parameter. Was: "+e+" and has been set to "+t),("string"==typeof t||t instanceof String)&&(e=t.toUpperCase())),window.ddnawrapper.diagnostic.log("Current user nation is: "+e+". Special territories is: "+n),-1!==n.indexOf(e)}function E(){return window.GlobalConfiguration.externalLibrary.includes("paradigma")}function T(){return window.GlobalConfiguration.externalLibrary.includes("segment")}var W=!1,_=!1,G=!1,x=!1,D="anonymous_user",U=!1,L=30;function F(n){j()&&!_?(window.ddnawrapper.diagnostic.log("tracking consent given - proceed with Segment setup"),function(n){if(!window.segmentInit){var e=R();window.AnalyticsWrapper.load(n,{integrations:e}),window.segmentInit=!0,W?B():(window.ddnawrapper.diagnostic.log("regular territory - tracking consent given - fire identify (accepted)"),window.ddnawrapper.analytics.identify({gdpr_privacy:"accepted",is_special_market:!1,purposes:(t=window.GlobalConfiguration.segmentGranularConsentConfiguration.nonSpecialTerritories.purposesCategories,{analytics:S(t.analytics.category),retargeting:S(t.retargeting.category),profiling:S(t.profiling.category),marketing:S(t.marketing.category)})}))}var t}(n)):(W?window.segmentInit?M():N(n,z):window.ddnawrapper.diagnostic.log("tracking consent not given - segment not loaded"),window.segmentInitializationCompleted=!0)}function R(){var n=W?$().specialTerritories.destinationPreferences:$().nonSpecialTerritories.destinationPreferences,e={};for(var t in n)e[t]=S(n[t]);return e}function N(n,e){if(window.ddnawrapper.diagnostic.log("special market - proceed with Segment setup"),!window.segmentInit){var t=R();window.AnalyticsWrapper.load(n,{integrations:t}),e(),window.segmentInit=!0}}function M(){j()?B():z()}function V(){window.ddnawrapper.diagnostic.log("special market - fire identify (pending)");var n=$().specialTerritories.purposesCategories;window.ddnawrapper.analytics.identify({gdpr_privacy:"pending",is_special_market:!0,purposes:{analytics:n.analytics.valueOnPendingConsent,retargeting:n.retargeting.valueOnPendingConsent,profiling:n.profiling.valueOnPendingConsent,marketing:n.marketing.valueOnPendingConsent}})}function B(){var n;window.ddnawrapper.diagnostic.log("special market - tracking consent given - fire identify (accepted)"),window.ddnawrapper.analytics.identify({gdpr_privacy:"accepted",is_special_market:!0,purposes:(n=window.GlobalConfiguration.segmentGranularConsentConfiguration.specialTerritories.purposesCategories,{analytics:S(n.analytics.category),retargeting:S(n.retargeting.category),profiling:S(n.profiling.category),marketing:S(n.marketing.category)})})}function z(){var n;window.ddnawrapper.diagnostic.log("special market - tracking consent not given - set generic anonymous id - fire identify (rejected)"),window.AnalyticsWrapper.setAnonymousId(D),window.ddnawrapper.analytics.identify({gdpr_privacy:"rejected",is_special_market:!0,purposes:(n=window.GlobalConfiguration.segmentGranularConsentConfiguration.specialTerritories.purposesCategories,{analytics:n.analytics.valueOnPendingConsent,retargeting:n.retargeting.valueOnPendingConsent,profiling:n.profiling.valueOnPendingConsent,marketing:n.marketing.valueOnPendingConsent})})}function J(){var n;if(window.dataLayer){var e=null===(n=window.AnalyticsWrapper.user())||void 0===n?void 0:n.anonymousId();window.dataLayer.push({anonymousId:e})}}function K(){var n=T(),e=E(),t=function(t){if("segment"===t&&(_=!0),"paradigma"===t&&(G=!0),n&&e?x=_&&G:n?x=_:e&&(x=G),x&&(J(),window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.events=window.ddnawrapper.events||{},!window.ddnawrapper.events.analyticsReady)){var r=new CustomEvent("analytics-ready");window.dispatchEvent(r),window.ddnawrapper.events.analyticsReady=!0}};n&&function(n){if(!window.setupAnalytics){window.setupAnalytics=!0;var e=window.analytics=window.analytics||[];if(e.initialize)return;if(e.invoked)return void(window.console&&console.error&&console.error("Segment snippet included twice."));e.invoked=!0,e.methods=["setAnonymousId","identify","track","ready","page"],e.factory=function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(n),e.push(t),e}};var t,r=function(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return A(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?A(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,d=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return a=n.done,n},e:function(n){d=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(d)throw i}}}}(e.methods);try{for(r.s();!(t=r.n()).done;){var o=t.value;e[o]=e.factory(o)}}catch(n){r.e(n)}finally{r.f()}e.load=function(t,r){(window.ddnawrapper.diagnostic||{}).log("SEGMENT - library load"+(void 0===r?"":" - options: "+JSON.stringify(r.integrations)));var o=document.createElement("script");o.type="text/javascript",o.async=!1,e.ready((function(){return n("segment")})),o.src="https://cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js",e._loadOptions=r;var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(o,i)},e.SNIPPET_VERSION="4.1.0"}}(t),e&&function(n){if(!window.setupParadigmaAnalytics){window.setupParadigmaAnalytics=!0;var e=window.ddna_library=window.ddna_library||[];if(e.initialize)return;if(e.invoked)return void(window.console&&console.error&&console.error("Segment snippet included twice."));e.invoked=!0,e.methods=["setAnonymousId","identify","track","ready","page"],e.factory=function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(n),e.push(t),e}};var t,r=function(n,e){var t="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=function(n,e){if(n){if("string"==typeof n)return I(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?I(n,e):void 0}}(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var r=0,o=function(){};return{s:o,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(n){throw n},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,d=!1;return{s:function(){t=t.call(n)},n:function(){var n=t.next();return a=n.done,n},e:function(n){d=!0,i=n},f:function(){try{a||null==t.return||t.return()}finally{if(d)throw i}}}}(e.methods);try{for(r.s();!(t=r.n()).done;){var o=t.value;e[o]=e.factory(o)}}catch(n){r.e(n)}finally{r.f()}e.load=function(t,r){(window.ddnawrapper.diagnostic||{}).log("PARADIGMA - library load"+(void 0===r?"":" - options: "+JSON.stringify(r.integrations)));var o=document.createElement("script");o.type="text/javascript",o.async=!1,e.ready((function(){return n("paradigma")})),o.src=window.GlobalConfiguration.paradigmaEndpoint,e._loadOptions=r;var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(o,i)},e.SNIPPET_VERSION="4.1.0"}}(t)}function $(){return window.GlobalConfiguration.segmentGranularConsentConfiguration}var q=function(){function e(){n(this,e),d(this,"getSegmentAnonymousIdQueryParam",(function(){var n=v();return n.segment_anonymousid||n.AnonymousID})),d(this,"isDisplayAsWebView",(function(){return"true"==new URLSearchParams(window.location.search.toLowerCase()).get("displayaswebview")}))}return o(e,[{key:"init",value:function(){try{var n=window.GlobalConfiguration||{};if(void 0!==window.DdnaOverrideConfiguration&&void 0!==window.DdnaOverrideConfiguration.isEmbeddedWidget&&(n.isEmbeddedWidget=window.DdnaOverrideConfiguration.isEmbeddedWidget),this.isDisplayAsWebView()||n.isDisplayedAsWebView||n.isAppView){var e=this.getSegmentAnonymousIdQueryParam();if(e&&n.segmentKeyAppsIos&&n.segmentKeyAppsAndroid){var t=y()?n.segmentKeyAppsIos:n.segmentKeyAppsAndroid;window.ddnawrapper.diagnostic.log("Initialize segment as web view"),function(n,e){window.GlobalConfiguration&&window.GlobalConfiguration.disableAnalytics||(K(),window.AnalyticsWrapper.setAnonymousId(e),window.segmentInit||(window.AnalyticsWrapper.load(n),window.segmentInit=!0))}(t,e)}}else if(n.isEmbeddedWidget){var r=n.segmentKeyEmbeds||"",o=n.segmentSpecialMarkets||"";window.ddnawrapper.diagnostic.log("Initialize segment as embedded widget"),function(n,e){if(!window.GlobalConfiguration||!window.GlobalConfiguration.disableAnalytics){var t=v(),r=t.marketingConsent&&"true"===t.marketingConsent,o=t.performanceConsent&&"true"===t.performanceConsent,i=t.consent_given&&"true"===t.consent_given;window.ddnawrapper.diagnostic.log("Embedded Widget - set cookie consent variable.\n    Performance consent: ".concat(o,", marketing consent: ").concat(r)),void 0===r&&void 0===o&&void 0!==i?(window.ddnawrapper.diagnostic.log("Embedded Widget - set cookie consent variable.\n      Using old consent parameter as a fallback: ".concat(i)),r=i,o=i):(void 0===r&&(r=!1),void 0===o&&(o=!1)),window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.consent=window.ddnawrapper.consent||{},window.ddnawrapper.consent.consentCategories={C0001:"1",C0002:o?"1":"0",C0003:"0",C0004:r?"1":"0",C0005:"0"},function(n,e){var t={rootMargin:"0px",threshold:1};window.ddnawrapper.diagnostic.log("embedded widget => check for intersection with parent before setup");var r=!1,o=function(n,e){n.isIntersecting&&!r?(window.ddnawrapper.diagnostic.log("embedded widget => start timed tracking"),function(){var n;U||(U=setInterval((n=function(){var n,e,t={seconds:L,nonInteraction:1};return e=function(){L+=30},(n=window.ddnawrapper.analytics.track("Pageview Heartbeat",t))&&n.then||(n=Promise.resolve(n)),e?n.then(e):n},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(n){return Promise.reject(n)}}).bind(this),3e4))}(),r=!0):r&&(window.ddnawrapper.diagnostic.log("embedded widget => stop timed tracking"),function(){clearInterval(this.trackTimedAction),U=!1}(),r=!1)};O(document.documentElement,t,(function(r,i){r.isIntersecting&&(window.ddnawrapper.diagnostic.log("embedded widget => intersecting, run segment"),K(),W=P(e),F(n),i.unobserve(r.target),O(document.documentElement,t,o))}))}(n,e)}}(r,o)}else{var i=n.segmentKey||"",a=n.segmentSpecialMarkets||"";window.ddnawrapper.diagnostic.log("Initialize segment"),function(n,e){window.GlobalConfiguration&&window.GlobalConfiguration.disableAnalytics||(K(),W=P(e),window.cookieLoadedTriggered?(window.ddnawrapper.diagnostic.log("onetrust cookie is present"),F(n)):(W&&(window.ddnawrapper.diagnostic.log("special market - onetrust cookie not present"),N(n,V),window.ddnawrapper.diagnostic.log("awaiting 'cookies-consent-updated' event"),window.addEventListener("cookies-consent-updated",(function(){window.ddnawrapper.diagnostic.log("received cookies consent updated"),W&&M()}))),window.ddnawrapper.diagnostic.log("awaiting 'cookies-loaded' event"),window.addEventListener("cookies-loaded",(function(){window.ddnawrapper.diagnostic.log("received cookies loaded event"),F(n)}))),window.addEventListener("cookies-consent-updated",(function(){window.ddnawrapper.diagnostic.log("received 'cookies-consent-updated' event => init segment again if needed"),function(){function n(){window.AnalyticsWrapper.user().anonymousId()===D&&(window.ddnawrapper.diagnostic.log("resetting anonymousId"),window.AnalyticsWrapper.reset(),J())}j()&&(window.AnalyticsWrapper.userIsReady()?n():window.AnalyticsWrapper.ready(n,!0))}()})))}(i,a)}return d&&d.then||(d=Promise.resolve(d)),d}catch(n){return Promise.reject(n)}var d}}]),e}();function H(){}var Q=function(){function e(){n(this,e)}return o(e,[{key:"init",value:function(){try{var n=window.deltatre.userNation;return(e=function(e){var t=function(){if(0===Object.keys(n).length)return console.log("user-nation not provided, try to read from "+m),function(n,e){return n&&n.then?n.then(H):Promise.resolve()}(fetch(m).then((function(n){return n.text()})).then((function(n){if(n){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.innerHTML=n,document.head.appendChild(e)}})).catch((function(n){console.warn("init (UserNation): ".concat(n))})))}();if(t&&t.then)return t.then(H)}())&&e.then||(e=Promise.resolve(e)),e}catch(n){return Promise.reject(n)}var e}}]),e}(),X=function(n){return"[object Object]"===toString.call(n)},Y=function(n){return"[object String]"===toString.call(n)};function Z(n,e){!function(n,e){if(e.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")}(n,e),e.add(n)}function nn(n,e,t){if(!e.has(n))throw new TypeError("attempted to get private field on non-instance");return t}var en=new WeakSet,tn=new WeakSet,rn=function(){function e(){n(this,e),Z(this,tn),Z(this,en)}return o(e,[{key:"getAnalyticsInstance",value:function(){return window.analytics}},{key:"getUser",value:function(){var n=T(),e=E();return n&&e||n?window.analytics.user:e&&window.ddna_library.user?window.ddna_library.user():void 0}},{key:"callFuncOnInstances",value:function(n){try{for(var e,t,r=function(e){console.error("Function ".concat(n," is undefined on ").concat(e))},o=arguments.length,i=new Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];T()&&(window.ddnawrapper.diagnostic.log("Call ".concat(n," on Segment")),window.analytics[n]?(e=window.analytics)[n].apply(e,i):r("window.analytics")),E()&&(window.ddnawrapper.diagnostic.log("Call ".concat(n," on Paradigma")),window.ddna_library[n]?(t=window.ddna_library)[n].apply(t,i):r("window.ddna_library"))}catch(n){console.log(n)}}},{key:"load",value:function(n,e){return window.ddnawrapper.diagnostic.log("load called"),this.callFuncOnInstances("load",n,e)}},{key:"ready",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.ddnawrapper.diagnostic.log("ready called"),e){var t=T(),r=E();if(t&&r)return window.analytics.ready(n)}return this.callFuncOnInstances("ready",n)}},{key:"reset",value:function(){return window.ddnawrapper.diagnostic.log("reset called"),this.callFuncOnInstances("reset")}},{key:"anonymousId",value:function(){return window.ddnawrapper.diagnostic.log("anonymousId called"),this.getUser().anonymousId()}},{key:"setAnonymousId",value:function(n){return window.ddnawrapper.diagnostic.log("setAnonymousId called"),this.callFuncOnInstances("setAnonymousId",n)}},{key:"userIsReady",value:function(){return window.ddnawrapper.diagnostic.log("userIsReady called"),this.getUser()}},{key:"user",value:function(){window.ddnawrapper.diagnostic.log("user called");var n=this.getUser();return"function"==typeof n?n():n}},{key:"page",value:function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return window.ddnawrapper.diagnostic.log("page called"),X(n)&&(t=n,e=n=void 0),X(e)&&(t=e,e=n,n=void 0),Y(n)&&!Y(e)&&(e=n,n=void 0),t.test_id=crypto.randomUUID(),t.viewport=nn(this,en,on).call(this),t.screen_resolution=nn(this,tn,an).call(this),this.callFuncOnInstances("page",n,e,t)}},{key:"track",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return window.ddnawrapper.diagnostic.log("track called"),e.test_id=crypto.randomUUID(),e.viewport=nn(this,en,on).call(this),e.screen_resolution=nn(this,tn,an).call(this),this.callFuncOnInstances("track",n,e)}},{key:"identify",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return window.ddnawrapper.diagnostic.log("identify called"),X(n)&&(t=e,e=n),t.test_id=crypto.randomUUID(),t.viewport=nn(this,en,on).call(this),t.screen_resolution=nn(this,tn,an).call(this),this.callFuncOnInstances("identify",n,e,t)}},{key:"addSourceMiddleware",value:function(n){return window.ddnawrapper.diagnostic.log("addSourceMiddleware called"),this.callFuncOnInstances("addSourceMiddleware",n)}}]),e}();function on(){var n=document.documentElement.clientWidth||0,e=document.documentElement.clientHeight||0;return"".concat(n," x ").concat(e)}function an(){var n=window.screen.width,e=window.screen.height;return"".concat(n," x ").concat(e)}function dn(){}var sn=!1;function cn(n,e){if(!e)return n&&n.then?n.then(dn):Promise.resolve()}var un=[];function ln(n){var e=n();if(e&&e.then)return e.then(dn)}var pn=[];function wn(n,e,t){return t?e?e(n):n:(n&&n.then||(n=Promise.resolve(n)),e?n.then(e):n)}var fn=[],gn=void 0;function vn(n,e){var t=n();return t&&t.then?t.then(e):e(t)}var yn=void 0;function hn(n,e,t){if(!n.s){if(t instanceof mn){if(!t.s)return void(t.o=hn.bind(null,n,e));1&e&&(e=t.s),t=t.v}if(t&&t.then)return void t.then(hn.bind(null,n,e),hn.bind(null,n,2));n.s=e,n.v=t;const r=n.o;r&&r(n)}}var mn=function(){function n(){}return n.prototype.then=function(e,t){var r=new n,o=this.s;if(o){var i=1&o?e:t;if(i){try{hn(r,1,i(this.v))}catch(n){hn(r,2,n)}return r}return this}return this.o=function(n){try{var o=n.v;1&n.s?hn(r,1,e?e(o):o):t?hn(r,1,t(o)):hn(r,2,o)}catch(n){hn(r,2,n)}},r},n}();function bn(n){return n instanceof mn&&1&n.s}function Cn(n,e,t){for(var r;;){var o=n();if(bn(o)&&(o=o.v),!o)return i;if(o.then){r=0;break}var i=t();if(i&&i.then){if(!bn(i)){r=1;break}i=i.s}if(e){var a=e();if(a&&a.then&&!bn(a)){r=2;break}}}var d=new mn,s=hn.bind(null,d,2);return(0===r?o.then(u):1===r?i.then(c):a.then(l)).then(void 0,s),d;function c(r){i=r;do{if(e&&(a=e())&&a.then&&!bn(a))return void a.then(l).then(void 0,s);if(!(o=n())||bn(o)&&!o.v)return void hn(d,1,i);if(o.then)return void o.then(u).then(void 0,s);bn(i=t())&&(i=i.v)}while(!i||!i.then);i.then(c).then(void 0,s)}function u(n){n?(i=t())&&i.then?i.then(c).then(void 0,s):c(i):hn(d,1,i)}function l(){(o=n())?o.then?o.then(u).then(void 0,s):u(o):hn(d,1,i)}}function kn(n){if(n&&n.then)return n.then(dn)}var On=function(){function e(){n(this,e),window.AnalyticsWrapper=new rn}return o(e,[{key:"configureWithJson",value:function(n){var e=JSON.parse(n);e&&(window.GlobalConfiguration=Object.assign(window.GlobalConfiguration,e))}},{key:"isConfigurationValid",value:function(n){var e,t;return n&&(null==n||null===(e=n.segmentKey)||void 0===e?void 0:e.length)>0&&(null==n||null===(t=n.segmentKeyEmbeds)||void 0===t?void 0:t.length)>0}},{key:"readConfiguration",value:function(){try{var n=this;return wn(ln((function(){if(!n.isConfigurationValid(window.GlobalConfiguration))return cn(fetch(function(){var n=document.querySelector("script[src*='ddna-configuration']").getAttribute("src");try{var e=new URL(n).hostname;return"https://".concat(e,"/en/api/v1/ddna-configuration/")}catch(n){return"https://olympics.com/en/api/v1/ddna-configuration/"}}()).then((function(n){return n.json()})).then((function(n){window.GlobalConfiguration=Object.assign(window.GlobalConfiguration,n),window.ddnawrapper.diagnostic.log("global configuration read from fallback endpoint /api/v1/ddna-configuration")})))})))}catch(n){return Promise.reject(n)}}},{key:"init",value:function(){try{var n=this;return window.ddnawrapper=window.ddnawrapper||{},window.ddnawrapper.analytics=window.ddnawrapper.analytics||{},window.ddnawrapper.analytics.track=n.track,window.ddnawrapper.analytics.page=n.page,window.ddnawrapper.analytics.identify=n.identify,window.ddnawrapper.analytics.reset=n.reset,window.ddnawrapper.analytics.sendCachedEventsWithTraits=n.sendCachedEventsWithTraits,window.ddnawrapper.analytics.consentGiven=n.consentGiven,window.ddnawrapper.user=window.ddnawrapper.user||{},window.ddnawrapper.user.anonymousId=n.anonymousId,window.addEventListener("analytics-ready",(e=function(){return cn(n.setTraitsForAllEvents())},function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];try{return Promise.resolve(e.apply(this,n))}catch(n){return Promise.reject(n)}})),wn((new Q).init(),(function(){return(new c).init(),wn(n.readConfiguration(),(function(){return wn((yn=new q).init(),(function(){gn=new k;var e=window.GlobalConfiguration.injectOneTrust;return window.ddnawrapper.diagnostic.log("Inject one trust: ".concat(e)),ln((function(){if(e)return wn(n.loadConsentScript(),(function(){return cn(gn.init())}))}))}))}))}))}catch(n){return Promise.reject(n)}var e}},{key:"anonymousId",value:function(){window.ddnawrapper.diagnostic.log("'anonymousId' method invoked");var n=function(){var n;return null===(n=window.AnalyticsWrapper)||void 0===n?void 0:n.user().anonymousId()};return new Promise((function(e,t){try{if(window.AnalyticsWrapper.userIsReady())return e(n());window.addEventListener("analytics-ready",(function(){return e(n())}))}catch(n){t(n)}}))}},{key:"sendCachedEventsWithTraits",value:function(){try{var n=this;return wn(ln((function(){if(sn)return vn((function(){if(fn.length>0)return cn(n.sendIdentifyCachedEvents())}),(function(){return vn((function(){if(pn.length>0)return cn(n.sendPageCachedEvents())}),(function(){return ln((function(){if(un.length>0)return cn(n.sendTrackCachedEvents())}))}))}))})))}catch(n){return Promise.reject(n)}}},{key:"sendPageCachedEvents",value:function(){try{return wn(kn(Cn((function(){return(null==pn?void 0:pn.length)>0}),void 0,(function(){var n,e=pn.pop();return cn(null===(n=window.AnalyticsWrapper)||void 0===n?void 0:n.page(e.category,e.name,e.properties))}))))}catch(n){return Promise.reject(n)}}},{key:"sendTrackCachedEvents",value:function(){try{return wn(kn(Cn((function(){return(null==un?void 0:un.length)>0}),void 0,(function(){var n,e=un.pop();return cn(null===(n=window.AnalyticsWrapper)||void 0===n?void 0:n.track(e.event,e.properties))}))))}catch(n){return Promise.reject(n)}}},{key:"sendIdentifyCachedEvents",value:function(){try{return wn(kn(Cn((function(){return(null==fn?void 0:fn.length)>0}),void 0,(function(){var n,e=fn.pop();return cn(null===(n=window.AnalyticsWrapper)||void 0===n?void 0:n.identify(e.userId,e.traits))}))))}catch(n){return Promise.reject(n)}}},{key:"track",value:function(n,e){try{return window.ddnawrapper.diagnostic.log("'track' method invoked, with event name '".concat(n,"'.")),wn(function(){var t;if(sn)return wn(null===(t=window.AnalyticsWrapper)||void 0===t?void 0:t.track(n,e));un.push({event:n,properties:e})}())}catch(n){return Promise.reject(n)}}},{key:"page",value:function(n,e,t){try{return window.ddnawrapper.diagnostic.log("'page' method invoked with event name '".concat(e,"'")),wn(function(){var r;if(sn)return wn(null===(r=window.AnalyticsWrapper)||void 0===r?void 0:r.page(n,e,t));pn.push({category:n,name:e,properties:t})}())}catch(n){return Promise.reject(n)}}},{key:"consentGiven",value:function(n){try{return window.ddnawrapper.diagnostic.log("'consentGiven' method invoked, with data '".concat(JSON.stringify(n),"'.")),n&&gn.externalConsentGiven(n),wn()}catch(n){return Promise.reject(n)}}},{key:"identify",value:function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return window.ddnawrapper.diagnostic.log("'identify' method invoked, with userId '".concat(n,"'")),wn(function(){var t;if(sn)return wn(null===(t=window.AnalyticsWrapper)||void 0===t?void 0:t.identify(n,e));fn.push({userId:n,traits:e})}())}catch(n){return Promise.reject(n)}}},{key:"reset",value:function(){try{var n;return window.ddnawrapper.diagnostic.log("'reset' method invoked"),wn(null===(n=window.AnalyticsWrapper)||void 0===n?void 0:n.reset())}catch(n){return Promise.reject(n)}}},{key:"setTraitsForAllEvents",value:function(){try{var n=this;return sn=!0,wn(window.AnalyticsWrapper.addSourceMiddleware((function(e){var t=e.payload,r=e.next;e.integrations,t.obj.properties=t.obj.properties||{},t.obj.properties.traits=window.AnalyticsWrapper.user().traits(),t.obj.context.os=t.obj.context.os||{},t.obj.context.os.name=n.getOsName(),r(t)})),(function(){return cn(n.sendCachedEventsWithTraits())}))}catch(n){return Promise.reject(n)}}},{key:"getOsName",value:function(){var n;return null!==(n=yn)&&void 0!==n&&n.isDisplayAsWebView()?y()?"iOS":"android":null}},{key:"loadConsentScript",value:function(){try{var n=window.GlobalConfiguration||{};if(0==document.querySelectorAll('script[src="'.concat(b,'"]')).length){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src",b),e.setAttribute("charset","UTF-8"),e.setAttribute("crossorigin","anonymous"),e.setAttribute("data-domain-script",n.oneTrustDataDomainScript),document.head.appendChild(e)}else window.ddnawrapper.diagnostic.log("Consent script '".concat(b,"' was preloaded before init on wrapper."));return wn()}catch(n){return Promise.reject(n)}}}]),e}();(new On).init()}();
//# sourceMappingURL=ddna-wrapper.js.map?v=2e2eaf03ddc1e6fc